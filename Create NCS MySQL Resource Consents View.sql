-- Creates resource consents database view via a linked server to the NCS MySQL database (Need to setup linked server connection in SQL server first)
USE [GIS_Vector_Core]
GO
create view vwResourceConsents as SELECT * FROM OPENQUERY (NCS ,
'SELECT rg_resource_consents.consent_id, rg_property_records.upi_id AS Parcel_ID, ra_properties.ra_unique_id AS Property_Number, ra_properties.valuation_id AS Valuation_No, rg_resource_consents.consent_id AS Applicant_Debtor_No, rg_resource_consents.applicant_name AS Applicant_Name, rg_resource_consents.consent_type AS Consent_Type, rg_resource_consents.proposal_1 AS Proposal_1, rg_resource_consents.proposal_2 AS Proposal_2, rg_resource_consents.proposal_3 AS Proposal_3, rg_resource_consents.proposal_4 AS Proposal_4, rg_resource_consents.proposal_5 AS Proposal_5, ra_properties.house_no AS House_No, ra_streets.address_1 AS Address_1, ra_streets.address_2 AS Address_2, rg_resource_consents.legal_description_1 AS Legal, rg_resource_consents.legal_description_2 AS Legal_2, rg_resource_consents.status AS Status, rg_resource_consents.decision AS Decision, rg_resource_consents.conditions_yn AS Conditions_YN, rg_resource_consents.hearing_yn AS Hearing_YN, rg_resource_consents.notified_yn AS Notified_YN, rg_resource_consents.notifiable_yn AS Notifiable_YN, CAST(rg_resource_consents.application_date AS CHAR) AS application_date, CAST(rg_resource_consents.decision_notificn_date AS CHAR) AS decision_notificn_date,  rg_resource_consents.decision_details, rg_resource_consents.status_details, rg_resource_consents.consent_type_details, rg_resource_consents.district_plan_zone_details

FROM ((ra_properties INNER JOIN rg_resource_consents ON ra_properties.valuation_id = rg_resource_consents.valuation_id) INNER JOIN ra_streets ON ra_properties.street_id = ra_streets.street_id) LEFT JOIN rg_property_records ON ra_properties.ra_unique_id = rg_property_records.ra_unique_id');
GO
